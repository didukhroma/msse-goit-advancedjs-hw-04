{"version":3,"file":"commonHelpers.js","sources":["../src/js/common.js","../src/js/scroll.js","../src/js/api.js","../src/js/helpers.js","../src/js/iziToast.js","../src/js/simpleLightBox.js","../src/js/homeWork.js"],"sourcesContent":["/**\r\n * Authorization token\r\n *\r\n * @type {String} API Token\r\n */\r\nexport const AUTH_TOKEN = '20604497-76eef09585394ebdddc8f0af4';\r\n\r\n/**\r\n * Maximum value of results per page\r\n *\r\n * @type {Number}\r\n * @example const MAX_EL_PER_PAGE = 40;\r\n */\r\nexport const MAX_EL_PER_PAGE = 40;\r\n\r\n/**\r\n * References links object\r\n *\r\n * @type {{ form: HTMLElement; gallery: HTMLElement; guard: HTMLElement; goTop: HTMLElement; }}\r\n * @param {HTMLElement} form - reference link for form element\r\n * @param {HTMLElement} gallery - reference link for gallery element\r\n * @param {HTMLElement} guard - reference link for div guard element\r\n * @param {HTMLElement} goTop - reference link for button goTop element\r\n * \r\n * \r\n * @example const ref = {\r\n  form: document.querySelector('#search-form'),\r\n  gallery: document.querySelector('.gallery'),\r\n  guard: document.querySelector('.guard'),\r\n  goTop: document.querySelector('.js-go-top'),\r\n};\r\n */\r\nexport const ref = {\r\n  form: document.querySelector('#search-form'),\r\n  gallery: document.querySelector('.gallery'),\r\n  guard: document.querySelector('.guard'),\r\n  goTop: document.querySelector('.js-go-top'),\r\n};\r\n","import { ref } from './common';\r\n\r\n/**\r\n * Smooth scroll after adding new results\r\n *\r\n * @export\r\n * @example function scroll() {\r\n  const { height: cardHeight } =\r\n    ref.gallery.firstElementChild.getBoundingClientRect();\r\n\r\n  window.scrollBy({\r\n    top: cardHeight * 2,\r\n    behavior: 'smooth',\r\n  });\r\n}\r\n */\r\nexport function scroll() {\r\n  const { height: cardHeight } =\r\n    ref.gallery.firstElementChild.getBoundingClientRect();\r\n\r\n  window.scrollBy({\r\n    top: cardHeight * 2,\r\n    behavior: 'smooth',\r\n  });\r\n}\r\n\r\n/**\r\n * Scroll page to top \r\n *\r\n * @export function \r\n * @example function scrollToTop() {\r\n  window.scrollTo({\r\n    top: 0,\r\n    behavior: 'smooth',\r\n  }); \r\n */\r\nexport function scrollToTop() {\r\n  window.scrollTo({\r\n    top: 0,\r\n    behavior: 'smooth',\r\n  });\r\n}\r\n","import axios from 'axios';\r\nimport { AUTH_TOKEN, MAX_EL_PER_PAGE } from './common';\r\n\r\naxios.defaults.baseURL = 'https://pixabay.com/api/';\r\naxios.defaults.params = {\r\n  key: AUTH_TOKEN,\r\n  image_type: 'photo',\r\n  per_page: MAX_EL_PER_PAGE,\r\n  orientation: 'horizontal',\r\n  safesearch: true,\r\n};\r\n\r\n/**\r\n * Api service\r\n *\r\n * @class ServiceApi\r\n * @typedef {ServiceApi}\r\n */\r\nclass ServiceApi {\r\n  constructor() {\r\n    this.query = '';\r\n    this.page = 1;\r\n  }\r\n\r\n  async getPhoto() {\r\n    const response = await axios({\r\n      params: {\r\n        q: this.query,\r\n        page: this.page,\r\n      },\r\n    });\r\n    if (response.status !== 200) throw new Error(response.statusText);\r\n    return response.data;\r\n  }\r\n\r\n  nextPage() {\r\n    this.page += 1;\r\n  }\r\n\r\n  set searchQuery(newQuery) {\r\n    this.query = newQuery;\r\n  }\r\n  get searchQuery() {\r\n    return this.query;\r\n  }\r\n  startPage() {\r\n    this.page = 1;\r\n  }\r\n}\r\n\r\n/**\r\n * New example of instance SErviceApi\r\n *\r\n * @type {ServiceApi}\r\n */\r\nexport const service = new ServiceApi();\r\n","/**\r\n * Function for trim search query and return  string with symbol '+' instead of space\r\n *\r\n * @export\r\n * @param {String} query - input search query\r\n * @returns {String}\r\n * @example function prepareQueryForRequest(query) { // ' Red flower '\r\n  return query.trim().toLowerCase().replace(/\\s/g, '+'); //'red+flower'\r\n */\r\nexport function prepareQueryForRequest(query) {\r\n  return query.trim().toLowerCase().replace(/\\s/g, '+');\r\n}\r\n\r\n/**\r\n * Function for create markup from template\r\n *\r\n * @export\r\n * @param {Array} data\r\n * @returns {String}\r\n */\r\nexport function createMarkup(data) {\r\n  return data\r\n    .map(\r\n      ({\r\n        webformatURL,\r\n        tags,\r\n        likes,\r\n        views,\r\n        largeImageURL,\r\n        comments,\r\n        downloads,\r\n      }) => {\r\n        return `<div class=\"photo-card\" data-text=${tags} data-large=${largeImageURL}>\r\n    <div class=\"photo-wrapper\" >\r\n    <img class=\"photo\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"  />\r\n    </div>\r\n    <div class=\"info\">\r\n        <p class=\"info-item\">\r\n            <b>Likes</b>${likes}\r\n        </p>\r\n            <p class=\"info-item\">\r\n        <b>Views</b>${views}\r\n        </p>\r\n        <p class=\"info-item\">\r\n            <b>Comments</b>${comments}\r\n        </p>\r\n        <p class=\"info-item\">\r\n            <b>Downloads</b>${downloads}\r\n        </p>\r\n    </div>\r\n</div>`;\r\n      }\r\n    )\r\n    .join('');\r\n}\r\n","//Import\r\nimport iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n// iziToast.addEventListener('touchstart', function handle() {}, {\r\n//   passive: true,\r\n// });\r\n/**\r\n * Delay time for iziToast error message\r\n *\r\n * @type {Number} - time in milliseconds\r\n * @example const DELAY_TIME = 3000;\r\n */\r\nconst DELAY_TIME = 3000;\r\n\r\n/**\r\n * Error default message\r\n *\r\n * @type {String} - message for toast when error\r\n * @example const ERROR_DEFAULT_MESSAGE =\r\n  'Sorry, there are no images matching your search query. Please try again';\r\n */\r\nconst ERROR_DEFAULT_MESSAGE =\r\n  'Sorry, there are no images matching your search query. Please try again';\r\n\r\n/**\r\n * Warning default message\r\n *\r\n * @type {String} - message for toast when warning\r\n * @example const WARNING_DEFAULT_MESSAGE =\r\n  \"We're sorry, but you've reached the end of search results.\";\r\n */\r\nconst WARNING_DEFAULT_MESSAGE =\r\n  \"We're sorry, but you've reached the end of search results.\";\r\n/**\r\n * Settings for iziToast \r\n * \r\n * @type {{  timeout: number; position: string; }}\r\n * @example const iziToastSettings = {\r\n  timeout: DELAY_TIME,\r\n  position: 'topCenter',\r\n};\r\n*\r\n* @description Read more about iziToast settings at https://izitoast.marcelodolza.com/\r\n */\r\nconst iziToastSettings = {\r\n  timeout: DELAY_TIME,\r\n  position: 'topRight',\r\n};\r\n\r\n/**\r\n * Success Toast \r\n *\r\n * @export\r\n * @param {Number} totalHits - number of total results\r\n *  @description Read more about iziToast settings at https://izitoast.marcelodolza.com/\r\n * @example function successToast(totalHits) {\r\n  iziToastSettings.title = 'Hooray!';\r\n  iziToastSettings.message = `We found ${totalHits} images.`;\r\n  iziToast.success(iziToastSettings);\r\n}\r\n */\r\nexport function successToast(totalHits) {\r\n  iziToastSettings.title = 'Hooray!';\r\n  iziToastSettings.message = `We found ${totalHits} images.`;\r\n  iziToast.success(iziToastSettings);\r\n}\r\n\r\n/**\r\n * Error Toast \r\n *\r\n * @export\r\n * @param {String} message - error message\r\n * \r\n *  @description Read more about iziToast settings at https://izitoast.marcelodolza.com/\r\n * @example function errorToast(message) {\r\n  iziToastSettings.title = 'Error';\r\n  iziToastSettings.message = message || ERROR_DEFAULT_MESSAGE;\r\n  iziToast.error(iziToastSettings);\r\n}\r\n */\r\nexport function errorToast(message) {\r\n  iziToastSettings.title = 'Error';\r\n  iziToastSettings.message = message || ERROR_DEFAULT_MESSAGE;\r\n  iziToast.error(iziToastSettings);\r\n}\r\n\r\n/**\r\n * Warning Toast \r\n *\r\n * @export\r\n * \r\n *  @description Read more about iziToast settings at https://izitoast.marcelodolza.com/\r\n * @example function warningToast() {\r\n  iziToastSettings.title = 'Warning';\r\n  iziToastSettings.message = WARNING_DEFAULT_MESSAGE;\r\n  iziToast.warning(iziToastSettings);\r\n}\r\n}\r\n */\r\nexport function warningToast() {\r\n  iziToastSettings.title = 'Warning';\r\n  iziToastSettings.message = WARNING_DEFAULT_MESSAGE;\r\n  iziToast.warning(iziToastSettings);\r\n}\r\n","import SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\n/**\r\n * Settings for simple light box \r\n *\r\n * @type {{ selector: string; srcImage: string; caption: string; }}\r\n * @param {String} selector - select all elements to collection\r\n * @description Read more in https://simplelightbox.com/\r\n * @example const settingsSimpleLightbox = {\r\n  selector: '.photo-card',\r\n  srcImage: 'data-large',\r\n  caption: 'data-text',\r\n};\r\n */\r\nconst settingsSimpleLightbox = {\r\n  selector: '.photo-card',\r\n  srcImage: 'data-large',\r\n  caption: 'data-text',\r\n};\r\n\r\n/**\r\n * New example of instance  SimpleLightbox\r\n *\r\n *@description Read more in https://simplelightbox.com/\r\n @example new SimpleLightbox(settingsSimpleLightbox.selector, {\r\n  sourceAttr: settingsSimpleLightbox.srcImage,\r\n  captionsData: settingsSimpleLightbox.caption,\r\n  captionDelay: 250,\r\n  animationSpeed: 500,\r\n});\r\n */\r\nconst galleryLightBox = new SimpleLightbox(settingsSimpleLightbox.selector, {\r\n  sourceAttr: settingsSimpleLightbox.srcImage,\r\n  captionsData: settingsSimpleLightbox.caption,\r\n  captionDelay: 250,\r\n  animationSpeed: 500,\r\n});\r\n\r\nexport { galleryLightBox };\r\n","import throttle from 'lodash.throttle';\r\nimport { scroll, scrollToTop } from './scroll';\r\nimport { service } from './api';\r\nimport { MAX_EL_PER_PAGE, ref } from './common';\r\nimport { prepareQueryForRequest, createMarkup } from './helpers';\r\nimport { successToast, warningToast, errorToast } from './iziToast';\r\nimport { galleryLightBox } from './simpleLightBox';\r\n\r\nconst input = ref.form.elements.searchQuery;\r\n\r\nref.form.addEventListener('submit', handleSubmit);\r\ninput.addEventListener('input', throttle(handleInput, 300)); //hide button load more when change search query\r\nref.goTop.addEventListener('click', handleClick); //---GO TOP\r\nwindow.addEventListener('scroll', trackScroll);\r\nwindow.addEventListener('load', trackScroll);\r\n\r\n//disabled enable search btn\r\nfunction handleInput() {\r\n  const buttonSearch = ref.form.elements[1];\r\n  if (!input.value) {\r\n    buttonSearch.disabled = true;\r\n    return;\r\n  }\r\n  if (!buttonSearch.disabled) return;\r\n  buttonSearch.disabled = false;\r\n}\r\n\r\n//submit\r\nasync function handleSubmit(e) {\r\n  e.preventDefault();\r\n\r\n  const query = prepareQueryForRequest(\r\n    e.currentTarget.children.searchQuery.value\r\n  );\r\n\r\n  if (query !== service.searchQuery) {\r\n    observer.unobserve(ref.guard);\r\n    service.startPage();\r\n    service.searchQuery = query;\r\n    ref.gallery.innerHTML = '';\r\n  }\r\n\r\n  try {\r\n    const response = await service.getPhoto();\r\n    const { totalHits, hits } = response;\r\n\r\n    if (!totalHits) {\r\n      throw new Error('');\r\n    }\r\n\r\n    if (totalHits > MAX_EL_PER_PAGE) {\r\n      observer.observe(ref.guard);\r\n    }\r\n\r\n    const markup = createMarkup(hits);\r\n    ref.gallery.insertAdjacentHTML('beforeend', markup);\r\n\r\n    successToast(totalHits);\r\n    galleryLightBox.refresh();\r\n  } catch (error) {\r\n    console.log(error);\r\n    errorToast(error.message);\r\n  }\r\n}\r\n//Infinite scroll\r\nconst options = {\r\n  rootMargin: '400px',\r\n};\r\n\r\nconst callback = (entries, observer) => {\r\n  entries.forEach(async entry => {\r\n    if (entry.isIntersecting) {\r\n      service.nextPage();\r\n      try {\r\n        const response = await service.getPhoto();\r\n        const { totalHits, hits } = response;\r\n\r\n        if (totalHits < MAX_EL_PER_PAGE * service.page) {\r\n          observer.unobserve(ref.guard);\r\n          warningToast();\r\n        }\r\n\r\n        const markup = createMarkup(hits);\r\n        ref.gallery.insertAdjacentHTML('beforeend', markup);\r\n\r\n        galleryLightBox.refresh();\r\n        scroll();\r\n      } catch (error) {\r\n        console.log(error);\r\n        errorToast(error.message);\r\n      }\r\n    }\r\n  });\r\n};\r\nconst observer = new IntersectionObserver(callback, options);\r\n//------------------------------------------------------\r\n//Scroll to top\r\nfunction handleClick() {\r\n  scrollToTop();\r\n}\r\nfunction trackScroll() {\r\n  window.removeEventListener('load', trackScroll);\r\n\r\n  const windowHeight = window.scrollY;\r\n\r\n  if (windowHeight > 800) {\r\n    ref.goTop.classList.remove('visually-hidden');\r\n  } else {\r\n    ref.goTop.classList.add('visually-hidden');\r\n  }\r\n}\r\n"],"names":["AUTH_TOKEN","MAX_EL_PER_PAGE","ref","scroll","cardHeight","scrollToTop","axios","ServiceApi","response","newQuery","service","prepareQueryForRequest","query","createMarkup","data","webformatURL","tags","likes","views","largeImageURL","comments","downloads","DELAY_TIME","ERROR_DEFAULT_MESSAGE","WARNING_DEFAULT_MESSAGE","iziToastSettings","successToast","totalHits","iziToast","errorToast","message","warningToast","settingsSimpleLightbox","galleryLightBox","SimpleLightbox","input","handleSubmit","throttle","handleInput","handleClick","trackScroll","buttonSearch","observer","hits","markup","error","options","callback","entries","entry"],"mappings":"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"}