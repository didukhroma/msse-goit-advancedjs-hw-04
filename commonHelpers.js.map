{"version":3,"file":"commonHelpers.js","sources":["../src/js/common.js","../src/js/api.js","../src/js/helpers.js","../src/js/iziToast.js","../src/js/simpleLightBox.js","../src/js/homeWork.js"],"sourcesContent":["export const AUTH_TOKEN = '20604497-76eef09585394ebdddc8f0af4';\r\n\r\nexport const MAX_EL_PER_PAGE = 40;\r\n\r\nexport const HIDDEN_CLASS = 'visually-hidden';\r\n\r\nexport const ref = {\r\n  form: document.querySelector('#search-form'),\r\n  gallery: document.querySelector('.gallery'),\r\n  guard: document.querySelector('.guard'),\r\n};\r\n","import axios from 'axios';\r\nimport { AUTH_TOKEN, MAX_EL_PER_PAGE } from './common';\r\n\r\n/**\r\n *\r\n */\r\naxios.defaults.baseURL = 'https://pixabay.com/api/';\r\naxios.defaults.params = {\r\n  key: AUTH_TOKEN,\r\n  image_type: 'photo',\r\n  per_page: MAX_EL_PER_PAGE,\r\n  orientation: 'horizontal',\r\n  safesearch: true,\r\n};\r\n\r\nexport function fetchPhotos(query = '', page = 1) {\r\n  if (!query) return;\r\n  return axios({\r\n    params: {\r\n      q: query,\r\n      page: page,\r\n    },\r\n  });\r\n}\r\n\r\nexport function checkResponseStatus(response) {}\r\n\r\nclass ServiceApi {\r\n  constructor() {\r\n    this.query = '';\r\n    this.page = 1;\r\n  }\r\n\r\n  async getPhoto() {\r\n    const response = await axios({\r\n      params: {\r\n        q: this.query,\r\n        page: this.page,\r\n      },\r\n    });\r\n    if (response.status !== 200) throw new Error(response.statusText);\r\n    return response.data;\r\n  }\r\n\r\n  nextPage() {\r\n    this.page += 1;\r\n  }\r\n\r\n  set searchQuery(newQuery) {\r\n    this.query = newQuery;\r\n  }\r\n  get searchQuery() {\r\n    return this.query;\r\n  }\r\n  startPage() {\r\n    this.page = 1;\r\n  }\r\n}\r\n\r\nexport const service = new ServiceApi();\r\n","export function prepareQueryForRequest(query) {\r\n  return query.trim().toLowerCase().replace(/\\s/g, '+');\r\n}\r\n\r\nexport function createMarkup(data) {\r\n  return data\r\n    .map(\r\n      ({\r\n        webformatURL,\r\n        tags,\r\n        likes,\r\n        views,\r\n        largeImageURL,\r\n        comments,\r\n        downloads,\r\n      }) => {\r\n        return `<div class=\"photo-card\" data-text=${tags} data-large=${largeImageURL}>\r\n    <div class=\"photo-wrapper\" >\r\n    <img class=\"photo\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"  />\r\n    </div>\r\n    <div class=\"info\">\r\n        <p class=\"info-item\">\r\n            <b>Likes</b>${likes}\r\n        </p>\r\n            <p class=\"info-item\">\r\n        <b>Views</b>${views}\r\n        </p>\r\n        <p class=\"info-item\">\r\n            <b>Comments</b>${comments}\r\n        </p>\r\n        <p class=\"info-item\">\r\n            <b>Downloads</b>${downloads}\r\n        </p>\r\n    </div>\r\n</div>`;\r\n      }\r\n    )\r\n    .join('');\r\n}\r\n","//Import\r\nimport iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n// iziToast.addEventListener('touchstart', function handle() {}, {\r\n//   passive: true,\r\n// });\r\n/**\r\n * Delay time for iziToast error message\r\n *\r\n * @type {Number} - time in milliseconds\r\n * @example const DELAY_TIME = 3000;\r\n */\r\nconst DELAY_TIME = 3000;\r\n\r\nconst ERROR_DEFAULT_MESSAGE =\r\n  'Sorry, there are no images matching your search query. Please try again';\r\n/**\r\n * Settings for iziToast \r\n * \r\n * @type {{  timeout: number; position: string; }}\r\n * @example const iziToastSettings = {\r\n  title: 'Error',\r\n  timeout: DELAY_TIME,\r\n  position: 'topCenter',\r\n  message: 'Oops! Something went wrong! Try reloading the page!',\r\n};\r\n*\r\n* @description Read more about iziToast settings at https://izitoast.marcelodolza.com/\r\n */\r\n// const iziToastSettings = {\r\n//   timeout: DELAY_TIME,\r\n//   position: 'topRight',\r\n// };\r\n\r\n/**\r\n * Show iziToast error message\r\n *@param {Number} totalHits  - total results\r\n * @export function\r\n * @example function errorToast() {\r\n  iziToast.error(iziToastSettings);\r\n}\r\n*@description Read more about iziToast settings at https://izitoast.marcelodolza.com/\r\n */\r\n\r\nconst iziToastSettings = {\r\n  title: 'Hooray!',\r\n  message: `We found 500 images.`,\r\n  timeout: DELAY_TIME,\r\n  position: 'topRight',\r\n};\r\nexport function successToast(totalHits) {\r\n  iziToastSettings.title = 'Hooray!';\r\n  iziToastSettings.message = `We found ${totalHits} images.`;\r\n  iziToast.success(iziToastSettings);\r\n}\r\n\r\nexport function errorToast(message) {\r\n  iziToastSettings.title = 'Error';\r\n  iziToastSettings.message = message || ERROR_DEFAULT_MESSAGE;\r\n  return iziToast.error(iziToastSettings);\r\n}\r\n\r\nexport function warningToast() {\r\n  iziToastSettings.title = 'Warning';\r\n  iziToastSettings.message =\r\n    \"We're sorry, but you've reached the end of search results.\";\r\n  return iziToast.warning(iziToastSettings);\r\n}\r\n","import SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\n// const settingsSimpleLightbox = {\r\n//   selector: '.photo',\r\n//   srcImage: 'data-large',\r\n//   caption: 'alt',\r\n// };\r\n\r\n/**\r\n * Description \r\n *\r\n * @type {{ selector: string; srcImage: string; caption: string; }}\r\n * @param {String} selector - select all elements to collection\r\n * @description\r\n * @example const settingsSimpleLightbox = {\r\n  selector: '.photo-card',\r\n  srcImage: 'data-large',\r\n  caption: 'data-text',\r\n};\r\n */\r\nconst settingsSimpleLightbox = {\r\n  selector: '.photo-card',\r\n  srcImage: 'data-large',\r\n  caption: 'data-text',\r\n};\r\n\r\nconst galleryLightBox = new SimpleLightbox(settingsSimpleLightbox.selector, {\r\n  sourceAttr: settingsSimpleLightbox.srcImage,\r\n  captionsData: settingsSimpleLightbox.caption,\r\n  captionDelay: 250,\r\n  animationSpeed: 500,\r\n});\r\n\r\nexport { galleryLightBox };\r\n","import throttle from 'lodash.throttle';\r\nimport { scroll } from './scroll';\r\nimport { fetchPhotos, checkResponseStatus, service } from './api';\r\nimport { MAX_EL_PER_PAGE, ref, HIDDEN_CLASS } from './common';\r\nimport { prepareQueryForRequest, createMarkup } from './helpers';\r\nimport { successToast, warningToast, errorToast } from './iziToast';\r\nimport { galleryLightBox } from './simpleLightBox';\r\n\r\nlet searchQuery = '';\r\nlet page = 1;\r\n\r\nconst input = ref.form.elements.searchQuery;\r\n\r\nref.form.addEventListener('submit', handleSubmit);\r\ninput.addEventListener('input', throttle(handleInput, 300)); //hide button load more when change search query\r\n\r\nfunction handleInput() {\r\n  const buttonSearch = ref.form.elements[1];\r\n  if (!input.value) {\r\n    buttonSearch.disabled = true;\r\n    return;\r\n  }\r\n  if (!buttonSearch.disabled) return;\r\n  buttonSearch.disabled = false;\r\n}\r\n\r\nasync function handleSubmit(e) {\r\n  e.preventDefault();\r\n\r\n  const query = prepareQueryForRequest(\r\n    e.currentTarget.children.searchQuery.value\r\n  );\r\n\r\n  if (query !== service.searchQuery) {\r\n    observer.unobserve(ref.guard);\r\n    service.startPage();\r\n    service.searchQuery = query;\r\n    ref.gallery.innerHTML = '';\r\n  }\r\n\r\n  try {\r\n    const response = await service.getPhoto();\r\n    const { totalHits, hits } = response;\r\n\r\n    if (!totalHits) {\r\n      throw new Error('');\r\n    }\r\n\r\n    if (totalHits > MAX_EL_PER_PAGE) {\r\n      observer.observe(ref.guard);\r\n    }\r\n\r\n    const markup = createMarkup(hits);\r\n    ref.gallery.insertAdjacentHTML('beforeend', markup);\r\n\r\n    successToast(totalHits);\r\n    galleryLightBox.refresh();\r\n  } catch (error) {\r\n    console.log(error);\r\n    errorToast(error.message);\r\n  }\r\n}\r\n//-----------------------------------------------------\r\nconst options = {\r\n  rootMargin: '200px',\r\n};\r\n\r\nconst callback = (entries, observer) => {\r\n  entries.forEach(async entry => {\r\n    if (entry.isIntersecting) {\r\n      service.nextPage();\r\n      try {\r\n        const response = await service.getPhoto();\r\n        const { totalHits, hits } = response;\r\n\r\n        if (totalHits < MAX_EL_PER_PAGE * service.page) {\r\n          observer.unobserve(ref.guard);\r\n          warningToast();\r\n        }\r\n\r\n        const markup = createMarkup(hits);\r\n        ref.gallery.insertAdjacentHTML('beforeend', markup);\r\n\r\n        successToast(totalHits);\r\n        galleryLightBox.refresh();\r\n      } catch (error) {\r\n        console.log(error);\r\n        errorToast(error.message);\r\n      }\r\n    }\r\n  });\r\n};\r\nconst observer = new IntersectionObserver(callback, options);\r\n"],"names":["AUTH_TOKEN","MAX_EL_PER_PAGE","ref","axios","ServiceApi","response","newQuery","service","prepareQueryForRequest","query","createMarkup","data","webformatURL","tags","likes","views","largeImageURL","comments","downloads","DELAY_TIME","ERROR_DEFAULT_MESSAGE","iziToastSettings","successToast","totalHits","iziToast","errorToast","message","warningToast","settingsSimpleLightbox","galleryLightBox","SimpleLightbox","input","handleSubmit","throttle","handleInput","buttonSearch","e","observer","hits","markup","error","options","callback","entries","entry"],"mappings":"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"}